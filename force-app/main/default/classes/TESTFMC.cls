public class TESTFMC {
public static void sendNotification(Boolean aa) {

        String key = '-----BEGIN PRIVATE KEY-----MIIEugIBADANBgkqhkiG9w0BAQEFAASCBKQwggSgAgEAAoIBAQCV3j7bNX7ynQZMAJ02Oav30hYkjnB+VtXca7bhxPRQWbsKhIXnIW3FpDq2ZZ/yASDRIBxaSWDGEj96IcDB7onQD+x/Ht92VTsP5+V89A7XP+rpF9SxRFhHBbcIK789fypvB3RVB+sdFG5EDZRryQgJmFo6ye66ATtCCu/jDKzuVoHve+0gmr1e2LiqzH9RCSuWe2K6S6APTtbveEt+rT22SF88b2EWXY5FxGHj9CE28+lzjUXLY3/eLz2ApTQPrSe3cBxEQhJOYYICEP3s8yVg68n4rYYELY8fO5yhSn19jxjh0RM0COZgCZhublcCOqt61jydnXgl+DcQchRouCLpAgMBAAECgf8LPk5ayWTiZU7P3VoMKFaJwRN+yLhrlNvvAEPdylnVNOYmNqzkGx3scjEEfhPFlCLpq6SxIVewV0S3KLL6jlu5ZfDnPjT+DZQN8EE/vLVCNJDrGQQ9z9tID1poK+8Waj81q8pwWmt92ZmZVD5OUEar+SP4+dL2qPPQrcUkSxLqdBs57jiNnV4zyNUHRpSYpes3o0ve266p+9hSNgQaUC9auOZEnbvP9vsmnn387tMhrhNzdyzSyC/WBlcIvVbe6+Kv7uAR44UalSUNEAX3Q82MMTiJxFlki4GM22DVD/ewMTtDiw/YM257StELMZY+wcQm20vtOLPhrT/0zrI+E4kCgYEAzR+3yumdJUM08+1dOC2acKExmoqaoWFIVw8B7MJxf1e1Zqgsp1dhAWqH8k7MYsTIjBcVqJ/xJ+3pQh4BYL8+rbXACp/Ea+Fl/Nx0A7wSo4+zGDHjz2SgzmpaeXWbHxZOzxzwujH31HlbVlEZJQxe0tIB+F70YCovuAMRFRqeNWUCgYEAuwoUa74U/buEuxSY82F2wwYslq1vms60DUId+uVSLKZgivAuUT22xuefSITnl/N6iLLyNVl+wJuEUmqYkx3pS92voLI4oW2TdBOPcP2Zfm+rHm+Gm8uxYoZ8KUX1d65ucSpH0OZB7C9cRLFivlc0r+3CIxDxdw0SaIBETjk38TUCgYAC2FbHRLg+RRFd9MPfPJqwxzuV5ihA5sWHF5kyPHwwhPnqI5kC9S5OQ7kA/mDNWediMgvF2/oPULh0h1ADlIN9C1FPlGm4CVdNy4z8ZEZp6FtWkZKUVNP6KPV6S8xMARY0vzUDkB/c3ZYLu3I61lIWYH1QgZioIM2qorhA766UFQKBgCUB1o6G2pJlktqNNcIaC6yEwTfC8y0XLurcpR/qVbr95GY5JYDvjAWI+KwZl9Up2JnJhkDmBz1GyASikLOzHGDlaQWLncba7mzuHdiGZONuZtYrzN9wixVqdJCaBfp7KeD8M59yn6KCsGfrDRWKHaOdkGbtyEj87iJ9Foa/rYDtAoGAcHyjn9ozncNI528dxQn4Bdx0JVOiLeyvHqmwvMq9yjxy/eRO/+/ReJZwAlCmUTGyRN4DJBc82fZakp53M1W2u7wO+kLUv8ym9xwrsBSUACRhAULnsNDIdTU0zO27NtgwLX1LR8wfk5v3vXZoxw1qeUWHmHR2F8bIeXi+wkdEbgg=-----END PRIVATE KEY-----';
        String key2 = '\nMIIEugIBADANBgkqhkiG9w0BAQEFAASCBKQwggSgAgEAAoIBAQCV3j7bNX7ynQZM\nAJ02Oav30hYkjnB+VtXca7bhxPRQWbsKhIXnIW3FpDq2ZZ/yASDRIBxaSWDGEj96\nIcDB7onQD+x/Ht92VTsP5+V89A7XP+rpF9SxRFhHBbcIK789fypvB3RVB+sdFG5E\nDZRryQgJmFo6ye66ATtCCu/jDKzuVoHve+0gmr1e2LiqzH9RCSuWe2K6S6APTtbv\neEt+rT22SF88b2EWXY5FxGHj9CE28+lzjUXLY3/eLz2ApTQPrSe3cBxEQhJOYYIC\nEP3s8yVg68n4rYYELY8fO5yhSn19jxjh0RM0COZgCZhublcCOqt61jydnXgl+DcQ\nchRouCLpAgMBAAECgf8LPk5ayWTiZU7P3VoMKFaJwRN+yLhrlNvvAEPdylnVNOYm\nNqzkGx3scjEEfhPFlCLpq6SxIVewV0S3KLL6jlu5ZfDnPjT+DZQN8EE/vLVCNJDr\nGQQ9z9tID1poK+8Waj81q8pwWmt92ZmZVD5OUEar+SP4+dL2qPPQrcUkSxLqdBs5\n7jiNnV4zyNUHRpSYpes3o0ve266p+9hSNgQaUC9auOZEnbvP9vsmnn387tMhrhNz\ndyzSyC/WBlcIvVbe6+Kv7uAR44UalSUNEAX3Q82MMTiJxFlki4GM22DVD/ewMTtD\niw/YM257StELMZY+wcQm20vtOLPhrT/0zrI+E4kCgYEAzR+3yumdJUM08+1dOC2a\ncKExmoqaoWFIVw8B7MJxf1e1Zqgsp1dhAWqH8k7MYsTIjBcVqJ/xJ+3pQh4BYL8+\nrbXACp/Ea+Fl/Nx0A7wSo4+zGDHjz2SgzmpaeXWbHxZOzxzwujH31HlbVlEZJQxe\n0tIB+F70YCovuAMRFRqeNWUCgYEAuwoUa74U/buEuxSY82F2wwYslq1vms60DUId\n+uVSLKZgivAuUT22xuefSITnl/N6iLLyNVl+wJuEUmqYkx3pS92voLI4oW2TdBOP\ncP2Zfm+rHm+Gm8uxYoZ8KUX1d65ucSpH0OZB7C9cRLFivlc0r+3CIxDxdw0SaIBE\nTjk38TUCgYAC2FbHRLg+RRFd9MPfPJqwxzuV5ihA5sWHF5kyPHwwhPnqI5kC9S5O\nQ7kA/mDNWediMgvF2/oPULh0h1ADlIN9C1FPlGm4CVdNy4z8ZEZp6FtWkZKUVNP6\nKPV6S8xMARY0vzUDkB/c3ZYLu3I61lIWYH1QgZioIM2qorhA766UFQKBgCUB1o6G\n2pJlktqNNcIaC6yEwTfC8y0XLurcpR/qVbr95GY5JYDvjAWI+KwZl9Up2JnJhkDm\nBz1GyASikLOzHGDlaQWLncba7mzuHdiGZONuZtYrzN9wixVqdJCaBfp7KeD8M59y\nn6KCsGfrDRWKHaOdkGbtyEj87iJ9Foa/rYDtAoGAcHyjn9ozncNI528dxQn4Bdx0\nJVOiLeyvHqmwvMq9yjxy/eRO/+/ReJZwAlCmUTGyRN4DJBc82fZakp53M1W2u7wO\n+kLUv8ym9xwrsBSUACRhAULnsNDIdTU0zO27NtgwLX1LR8wfk5v3vXZoxw1qeUWH\nmHR2F8bIeXi+wkdEbgg=\n';
        String clId = '103727169262486456723';
        String pjtId = 'samsung-partner-portal';
        String sendKey;
        if(aa){
            sendKey = key;
        } else {
            sendKey = key2;
        }

        String accessToken = generateJWT(sendKey, clId);
        HttpRequest request = prepareRequest(pjtId, accessToken);

        Http http = new Http();
        HTTPResponse response = http.send(request);
        System.debug('response ==> ' + response);
}


public static String generateJWT(String privateKey, String clientID) {
    //example
    //privateKey = 'MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCjSe21kQhGJVbP...';
    //clientID = '583536554635647655647';

    String scope = 'https://www.googleapis.com/auth/firebase.messaging';
    String aud = 'https://oauth2.googleapis.com/token';
    Long iat = DateTime.now().getTime();
    Long exp = DateTime.now().addMinutes(60).getTime();

    String jwtHeader = '{"alg":"RS256","typ":"JWT"}';
    String jwtPayload =
            '{"iss":"' + clientID + '","scope":"' + scope + '","aud":"' + aud + '","iat":' +
                    iat +
                    ',"exp":' +
                    exp +
                    '}';

    String encodedHeader = base64URLEncode(Blob.valueOf(jwtHeader));
    String encodedPayload = base64URLEncode(Blob.valueOf(jwtPayload));

    String signatureInput = encodedHeader + '.' + encodedPayload;

    Blob privateKeyBlob = EncodingUtil.base64Decode(privateKey);

    Blob signatureBlob = Crypto.sign('RSA-SHA256', Blob.valueOf(signatureInput), privateKeyBlob);
    String encodedSignature = base64UrlEncode(signatureBlob);

    return encodedHeader + '.' + encodedPayload + '.' + encodedSignature;
}

public static HttpRequest prepareRequest(String projectId, String accessToken) {
    HttpRequest request = new HttpRequest();
    request.setEndpoint('https://fcm.googleapis.com/v1/projects/' + projectId + '/messages:send');
    request.setMethod('POST');
    request.setHeader('Content-Type', 'application/json');
    request.setHeader('Authorization', 'Bearer ' + accessToken);

    String devicePushToken = '09568cmx983up98vb687yp9e85p49y5-6506b7...';
    String title = 'test title';
    String body = 'test body';

    request.setBody(generateBodyForSingleToken(devicePushToken, title, body));
    return request;
}

public static String generateBodyForSingleToken(String devicePushToken, String title, String body) {
    String bodyToSend =
            '{' +
                    '"message":' +
                    '{' +
                    '"token": "' + devicePushToken +
                    '", "notification": {' +
                    '"title": "' + title +
                    '", "body": "' + body +
                    '"},' +
                    '"dry_run": ' + true +
                    '}' +
                    '}';
    return bodyToSend;
}

public static String base64URLEncode(Blob input){
    String output = EncodingUtil.base64Encode(input);
    output = output.replaceAll('\\+', '-').replaceAll('\\/', '_').replaceAll('=', '');
    return output;
}
}